services:
  neovim-dev:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        USERNAME: vscode
        USER_UID: 1000
        USER_GID: 1000
    container_name: powershellvim-neovim
    working_dir: /workspaces/PowerShellVIM
    command: /bin/bash -lc "container-bootstrap.sh --sync-workspace && sleep infinity"
    stdin_open: true
    tty: true
    environment:
      TERM: xterm-256color
      SOURCE_REPO_DIR: /repo-src
      TARGET_WORKSPACE_DIR: /workspaces/PowerShellVIM
    volumes:
      - .:/repo-src:ro
      - workspace_repo:/workspaces/PowerShellVIM
      - nvim_config:/home/vscode/.config/nvim
      - nvim_data:/home/vscode/.local/share/nvim
      - nvim_state:/home/vscode/.local/state/nvim
      - nvim_cache:/home/vscode/.cache/nvim

volumes:
  workspace_repo:
  nvim_config:
  nvim_data:
  nvim_state:
  nvim_cache:
